<HTML>
<HEAD>
<TITLE>Net::OpenVPN::Manage - Manage an OpenVPN process via it's management port</TITLE>
<LINK REV="made" HREF="mailto:">
</HEAD>

<BODY>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#description">DESCRIPTION</A></LI>
	<LI><A HREF="#using the module">USING THE MODULE</A></LI>
	<LI><A HREF="#methods">METHODS</A></LI>
	<LI><A HREF="#version">VERSION</A></LI>
	<LI><A HREF="#author">AUTHOR</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P>Net::OpenVPN::Manage - Manage an OpenVPN process via it's management port</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<PRE>
  use Net::OpenVPN::Manage;</PRE>
<PRE>
  my $vpn = Net::OpenVPN::Manage-&gt;new({ 
                host=&gt;'127.0.0.1', 
                port=&gt;'6000', 
                password=&gt;'password',
                timeout=&gt;10
  });
</PRE>
<PRE>

  # Error if unable to connect.
  unless($vpn-&gt;connect()){
    print $vpn-&gt;{error_msg}.&quot;\n&quot;;
    exit 0;
  }</PRE>
<PRE>

  # Get the current status table in version 2 format from the process.
  my $status = $vpn-&gt;status(2);</PRE>
<PRE>

  # If method returned false, print error message.
  # Otherwise print table to STDOUT.
  if ( ! $status ) {
    print $vpn-&gt;{error_msg};
    exit 0;
  } else {
    print $status.&quot;\n&quot;;
  }</PRE>
<P>
<HR>
<H1><A NAME="description">DESCRIPTION</A></H1>
<P>This module connects to the OpenVPN management interface, executes 
commands on the interface and returns the results or errors that result.</P>
<P>
<HR>
<H1><A NAME="using the module">USING THE MODULE</A></H1>
<P>All the methods in this module will return 0, or boolean false if there is any error.
In most cases an error message detailing the problem will be returned in $obj-&gt;{error_msg}.</P>
<P>
<HR>
<H1><A NAME="methods">METHODS</A></H1>
<DL>
<DT><STRONG><A NAME="item_new">$vpn = Net::OpenVPN::Manage-&gt;new({ host=&gt;'', port=&gt;'', password=&gt;'', timeout=&gt;20 });</A></STRONG><BR>
<DD>
Constructs a new Net::OpenVPN::Manage object to connect to the specified process's management interface.
The anonymous hash that is passed specifies the target hostname or IP address, TCP port, and an optional password.
If no password is configured for your OpenVPN process, just omit the password reference. Optionally, you can
change the network timeout value as well.
<P></P>
<DT><STRONG><A NAME="item_connect">$vpn-&gt;connect();</A></STRONG><BR>
<DD>
The connect method has no arguments passed to it. This method connects to the remote host at the port specified, 
in the event that the host or port provided to the object are incorrect; or if there is already another network
session to this port (OpenVPN only supports a single management session at a time) this command will timeout.
<P>For more extensive information on the use of the OpenVPN management commands referenced by these methods, see the
OpenVPN documentation (http://www.openvpn.net) or at least the management help screen (print $vpn-&gt;help();).</P>
<P></P>
<DT><STRONG><A NAME="item_auth_retry">$vpn-&gt;auth_retry( $arg );</A></STRONG><BR>
<DD>
Changes the Auth failure retry mode. Arguments are: none, interact, or nointeract.
<P>$vpn-&gt;auth_retry('none'); # Sets auth-retry mode to 'none'</P>
<P></P>
<DT><STRONG><A NAME="item_echo">$vpn-&gt;echo( $arg );</A></STRONG><BR>
<DD>
Returns messages from the echo buffer or changes echo state. Arguments are: on, off, all, or a integer designating number of lines to be returned.
The on and off arguments are really of no use here since it changes the state of the realtime management console echo messages and our session only connected for a brief time.
<P>$vpn-&gt;echo('all'); # Returns entire echo buffer</P>
<P></P>
<DT><STRONG><A NAME="item_help">$vpn-&gt;help();</A></STRONG><BR>
<DD>
Returns the help screen for the management command usage.
<P>print $vpn-&gt;help(); # Prints the help screen to STDOUT</P>
<P></P>
<DT><STRONG><A NAME="item_hold">$vpn-&gt;hold( $arg );</A></STRONG><BR>
<DD>
If called without an argument it returns the current hold state; if called with an argument of: on, off, or release it changes the current hold state.
<P>$vpn-&gt;hold('release'); # Releases the hold state on the OpenVPN process.</P>
<P></P>
<DT><STRONG><A NAME="item_kill">$vpn-&gt;kill( $arg );</A></STRONG><BR>
<DD>
Kills the VPN connection referenced. The argument may be either the common name of the connection or the real client IP:Port address.
<P>$vpn-&gt;kill('jsmith'); # kills the connection with the common name of 'jsmith'</P>
<P>$vpn-&gt;kill('63.73.83.93:17023'); # kills the connection where the client is connecting from: '63.73.83.93:17023'</P>
<P></P>
<DT><STRONG><A NAME="item_log">$vpn-&gt;log( $arg );</A></STRONG><BR>
<DD>
Returns messages from the log buffer or changes realtime log state. Arguments are: on, off, all, or an integer designating number of lines to be returned.
The on and off arguments are really of no use here since it changes the state of the realtime management console log messages and our session only connected for a brief time.
<P>print $vpn-&gt;log('all'); # prints the entire log buffer.</P>
<P></P>
<DT><STRONG><A NAME="item_mute">$vpn-&gt;mute( $arg );</A></STRONG><BR>
<DD>
If no argument is given it will show the log mute level for recurring log messages; if called with an argument it will change the log mute level to the value given.
<P>$vpn-&gt;mute( 10 ); # Sets the log mute level to 10.</P>
<P></P>
<DT><STRONG><A NAME="item_net">$vpn-&gt;net();</A></STRONG><BR>
<DD>
This method has not been implemented. Only applicable on the Windows platform.
<P></P>
<DT><STRONG><A NAME="item_password">$vpn-&gt;password();</A></STRONG><BR>
<DD>
This method has not been implemented. Only of use when the management session is continuous - ours is not.
<P></P>
<DT><STRONG><A NAME="item_signal">$vpn-&gt;signal( $arg );</A></STRONG><BR>
<DD>
Sends a signal to the OpenVPN daemon process. Arugments are: SIGHUP, SIGTERM, SIGUSR1, or SIGUSR2.
If the daemon is running under a non root or Administrator|System account it will not be able to restart
itself after a reset since it won't have the priveledges required to reopen the network interfaces.
See the OpenVPN HOWTO and the OpenVPN Management Interface documentation.
<P>$vpn-&gt;signal('SIGHUP'); # Sends SIGHUP signal to the process.</P>
<P></P>
<DT><STRONG><A NAME="item_status">$vpn-&gt;status( $arg );</A></STRONG><BR>
<DD>
Returns the active connection status information where the optional argument (either 1 or 2 at this time) specifies the output format version.
<P>print $vpn-&gt;status(2); # Print the connection status page using the version 2 format.</P>
<P></P>
<DT><STRONG><A NAME="item_test">$vpn-&gt;test();</A></STRONG><BR>
<DD>
This method is not implemented. No real need to test management console.
<P></P>
<DT><STRONG><A NAME="item_username">$vpn-&gt;username();</A></STRONG><BR>
<DD>
This method has not been implemented. Only of use when the management session is continuous - ours is not.
<P></P>
<DT><STRONG><A NAME="item_verb">$vpn-&gt;verb( $arg );</A></STRONG><BR>
<DD>
If called without an argument it returns the log verbosity level; if called with an argument (any valid log level) it changes the verbosity setting to the given value.
<P>$vpn-&gt;verb('1'); # Change verbosity level to 1.</P>
<P></P>
<DT><STRONG><A NAME="item_version">$vpn-&gt;version();</A></STRONG><BR>
<DD>
Returns a string showing the processes version information as well as the management interface's version.
<P>print $vpn-&gt;version(); # Prints the version information to STDOUT.</P>
<P></P></DL>
<P>
<HR>
<H1><A NAME="version">VERSION</A></H1>
<P>0.01</P>
<P>
<HR>
<H1><A NAME="author">AUTHOR</A></H1>
<P>Copyright (c) 2006 Aaron Meyer / MeyerTech.net</P>
<P>This module is free software; you can redistribute it or modify it under
the same terms as Perl itself.</P>

</BODY>

</HTML>
